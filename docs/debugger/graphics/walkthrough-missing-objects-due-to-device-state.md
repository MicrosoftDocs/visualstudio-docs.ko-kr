---
title: '연습: 디바이스 상태로 인해 누락된 개체 | Microsoft Docs'
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 1b0d2bbd-0729-4aa5-8308-70c5bf1468c5
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 0e85aa8fc5af3f32f117b112e8624962a49d90c6
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/02/2020
ms.locfileid: "62895451"
---
# <a name="walkthrough-missing-objects-due-to-device-state"></a>연습: 디바이스 상태로 인해 누락된 개체
이 연습에서는 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] 그래픽 진단을 사용하여 잘못 구성된 디바이스 상태로 인해 누락된 개체를 조사하는 방법을 보여 줍니다.

 이 연습에서는 다음 방법을 설명합니다.

- **그래픽 이벤트 목록** 을 사용하여 문제의 잠재적인 원인을 찾습니다.

- **그래픽 파이프라인 단계** 창을 사용하여 `DrawIndexed` Direct3D API 호출의 효과를 확인합니다.

- **그래픽 픽셀 기록** 창을 사용하여 문제를 좀 더 구체적으로 찾습니다.

- 디바이스 상태에서 잠재적인 문제 또는 잘못된 구성이 있는지 검사합니다.

## <a name="scenario"></a>시나리오
 개체가 3D 앱에서 예상되는 위치에서 나타나지 않는 이유 중 하나는 그래픽 디바이스의 구성 오류로 인해 렌더링에서 제외되기 때문입니다. 예를 들어 감기 순서 때문에 삼각형이 잘못 추출되거나 깊이 테스트 함수 때문에 개체의 모든 픽셀이 거부될 수 있습니다.

 이 연습에 설명된 시나리오에서는 3D 앱 개발의 첫 번째 중요 시점에 도달했으며 최초로 테스트할 준비가 되었습니다. 그러나 앱을 실행할 때 사용자 인터페이스만 화면에 렌더링됩니다. 그래픽 진단을 사용하여 앱을 디버그할 수 있도록 그래픽 로그 파일 문제를 포착합니다. 이 문제는 앱에서 다음과 같이 보입니다.

 ![문제가 수정되기 전의 응용 프로그램](media/vsg_walkthru1_firstview.png "vsg_walkthru1_firstview")

 그래픽 로그의 그래픽 문제를 포착하는 방법에 대한 자세한 내용은 [Capturing Graphics Information](capturing-graphics-information.md)를 참조하세요.

## <a name="investigation"></a>조사
 그래픽 진단 도구를 사용하면 그래픽 로그 파일을 로드하여 테스트 중에 캡처한 프레임을 검사할 수 있습니다.

#### <a name="to-examine-a-frame-in-a-graphics-log"></a>그래픽 로그에서 프레임을 검사하려면

1. [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]에서 누락된 모델을 보여 주는 프레임이 포함된 그래픽 로그를 로드합니다. [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]에 새 그래픽 진단 탭이 나타납니다. 이 탭의 맨 윗부분에 선택한 프레임의 렌더링 대상 출력이 있습니다. 아래쪽에는 캡처된 각 프레임을 미리 보기 이미지로 표시하는 **프레임 목록**이 있습니다.

2. **프레임 목록**에서 모델이 표시되지 않는 것을 보여 주는 프레임을 선택합니다. 선택한 프레임을 반영하도록 렌더링 대상이 업데이트됩니다. 이 시나리오에서 그래픽 로그 탭은 다음과 같습니다.

    ![.vsglog 탭 프레임 버퍼 미리 보기 및 프레임 목록](media/vsg_walkthru1_experiment.png "vsg_walkthru1_experiment")

   문제를 보이는 프레임을 선택한 후에 **그래픽 이벤트 목록** 을 사용하여 프레임을 진단할 수 있습니다. **그래픽 이벤트 목록** 에는 활성 프레임을 렌더링하여 디바이스 상태를 설정하거나, 버퍼를 만들고 업데이트하거나, 프레임에 나타나는 개체를 그리는 등의 작업을 하기 위해 수행한 모든 Direct3D API 호출이 포함됩니다. 많은 유형의 호출은 앱이 예상대로 작동할 때 렌더링 대상에 항상은 아니지만 종종 해당 변경 사항이 생기므로 흥미롭습니다(예: 그리기, 디스패치, 복사 또는 지우기 호출). 그리기 호출은 각각 앱이 렌더링하는 기하 도형을 나타내므로 특히 흥미롭습니다(디스패치 호출도 기하 도형을 렌더링할 수 있음).

#### <a name="to-ensure-that-draw-calls-are-being-made"></a>그리기 호출이 수행되는지 확인하려면

1. **그래픽 이벤트 목록** 창을 엽니다. **그래픽 진단** 도구 모음에서 **이벤트 목록**을 선택합니다.

2. **그래픽 이벤트 목록** 에서 그리기 호출을 조사합니다. 더 쉽게 확인하려면 **그래픽 이벤트 목록** 창의 오른쪽 위 모서리에 있는 **검색** 상자에 "그리기"를 입력합니다. 그러면 목록이 필터링되어 제목에 "그리기"가 포함된 이벤트만 나타납니다. 이 시나리오에서는 여러 그리기 호출이 수행되었는지 검색합니다.

    ![캡처된 이벤트를 보여 주는 그래픽 이벤트 목록](media/vsg_walkthru1_.png "vsg_walkthru1_")

   그리기 호출이 수행되고 있는지 확인한 후에는 누락된 기하 도형에 해당하는 그리기 호출을 확인할 수 있습니다. 누락된 기하 도형이 렌더링 대상으로 그려지고 있지 않다는 것을 알고 있으므로(이 경우) **그래픽 파이프라인 단계** 창에서 누락된 기하 도형에 해당하는 그리기 호출을 확인할 수 있습니다. **그래픽 파이프라인 단계** 창은 렌더링 대상에 대한 효과에 상관없이 각 그리기 호출에 전송된 기하 도형을 보여 줍니다. 그리기 호출을 진행함에 따라, 파이프라인 단계가 각 호출과 관련된 기하 도형을 표시하도록 업데이트되고, 렌더링 대상 출력도 호출이 완료되면 렌더링 대상의 상태를 표시하도록 업데이트됩니다.

#### <a name="to-find-the-draw-call-for-the-missing-geometry"></a>누락된 기하 도형에 대한 그리기 호출을 찾으려면,

1. **그래픽 파이프라인 단계** 창을 엽니다. **그래픽 진단** 도구 모음에서 **파이프라인 단계**를 선택합니다.

2. **그래픽 파이프라인 단계** 창에서 누락된 모델을 보면서 각 그리기 호출을 따라 이동합니다. **입력 어셈블러** 단계에는 원시 모델 데이터가 표시됩니다. **꼭지점 셰이더** 단계에는 변환된 모델 데이터가 표시됩니다. **픽셀 셰이더** 단계에는 픽셀 셰이더 출력이 표시됩니다. **출력 병합기** 단계에는 이 그리기 호출 및 모든 이전 그리기 호출의 병합된 렌더링 대상이 표시됩니다.

3. 누락된 모델에 해당하는 그리기 호출에 도달하면 중지합니다. 이 시나리오에서 **그래픽 파이프라인 단계** 창에는 기하 도형이 렌더링되었으나 렌더링 대상에는 나타나지 않다는 사실이 표시됩니다.

    ![파이프라인 뷰어에서 누락된 개체를 보여 줌](media/vsg_walkthru1_pipeline.png "vsg_walkthru1_pipeline")

   앱이 누락된 기하 도형을 렌더링했는지 확인하고 해당 그리기 호출을 찾은 후에는 누락된 기하 도형을 표시하는 렌더링 대상 출력의 일부를 선택한 다음 **그래픽 픽셀 기록** 창에서 픽셀이 제외된 이유를 알아볼 수 있습니다. 픽셀 기록에는 특정 픽셀에 영향을 미쳤을 수 있는 모든 그리기 호출의 목록이 포함되어 있습니다. **그래픽 픽셀 기록** 창의 각 그리기 호출은 **그래픽 이벤트 목록** 창에도 표시되는 번호로 식별됩니다. 이 번호는 해당 픽셀이 누락된 기하 도형을 나타내는 것인지 확인하는 데 도움이 되며 픽셀이 제외된 이유를 알아보는 데도 유용합니다.

#### <a name="to-determine-why-the-pixel-was-excluded"></a>픽셀이 제외된 이유를 확인하려면

1. **그래픽 픽셀 기록** 창을 엽니다. **그래픽 진단** 도구 모음에서 **픽셀 기록**을 선택합니다.

2. **픽셀 셰이더** 축소판 그림을 기준으로, 누락된 기하 도형의 일부를 포함하는 프레임버퍼 출력의 픽셀을 선택합니다. 이 시나리오에서 픽셀 셰이더는 대부분의 렌더링 대상을 포함해야 합니다. 픽셀을 하나 선택하면 **그래픽 픽셀 기록** 창은 다음과 같이 표시됩니다.

    ![픽셀 기록 창에서 관련 그리기 호출을 보여 줌](media/vsg_walkthru1_hist1.png "vsg_walkthru1_hist1")

3. 조사하는 그리기 호출의 번호( **그래픽 이벤트 목록** 창)와 일치하는 그리기 호출 번호를 **그래픽 픽셀 기록** 창에서 찾아 선택한 렌더링 대상 픽셀이 해당 기하 도형의 일부를 포함하는지 확인합니다. **그래픽 픽셀 기록** 창의 어떤 호출도 조사 중인 그리기 호출과 일치하지 않을 경우 일치하는 호출을 찾을 때까지 이러한 단계(1단계 제외)를 반복합니다. 이 시나리오에서 일치하는 그리기 호출은 다음과 같습니다.

    ![조각 정보를 보여 주는 픽셀 기록 창](media/vsg_walkthru1_hist2.png "vsg_walkthru1_hist2")

4. 일치하는 호출을 찾으면 **그래픽 픽셀 기록** 창에서 일치하는 그리기 호출을 확장하고 픽셀이 제외되었는지 확인합니다. **그래픽 픽셀 기록** 창의 각 그리기 호출은 해당 개체의 기하 도형 결과로 해당 픽셀과 교차하는 기하학적 기본 형식(점, 선 또는 삼각형) 중 하나 이상에 해당합니다. 이러한 각 교차로 인해 픽셀의 최종 색상이 나타날 수 있습니다. 깊이 테스트에 실패했기 때문에 제외된 기본 형식은 왼쪽에서 오른쪽에 내려가는 화살표 위에 Z 문자가 표시되는 아이콘으로 구분됩니다.

5. 제외된 기본 형식을 확장하여 제외를 유발한 상태를 좀 더 자세히 검토합니다. **출력 병합기** 그룹에서 **결과**위로 포인터를 가져갑니다. 해당 기본 형식이 제외된 이유가 도구 설명에 표시됩니다. 이 시나리오에서 진행한 조사에 따르면 해당 기본 형식이 깊이 테스트에 실패했기 때문에 제외되었으므로 픽셀의 최종 색상에 영향을 주지 않음을 알 수 있습니다.

   해당 기본 형식이 깊이 테스트에 실패했기 때문에 기하 도형이 나타나지 않는다는 결론을 얻었으므로 이 문제가 잘못 구성된 디바이스 상태와 관련되어 있다고 생각할 수 있을 것입니다. **그래픽 개체 테이블**을 사용하여 디바이스 상태와 기타 Direct3D 개체 데이터를 검사할 수 있습니다.

#### <a name="to-examine-device-state"></a>디바이스 상태를 검사하려면

1. **그래픽 개체 테이블** 창을 엽니다. **그래픽 진단** 도구 모음에서 **개체 테이블**을 선택합니다.

2. **그래픽 개체 테이블** 에서 **D3D10 디바이스**개체를 찾은 후 **D3D10 디바이스** 개체를 엽니다. 새 **d3d10 디바이스** 탭이 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]에서 열립니다. 이 작업을 보다 쉽게 진행하기 위해 **그래픽 개체 테이블** 을 **유형**별로 정렬할 수 있습니다.

    ![그래픽 개체 테이블 및 관련 장치 상태](media/vsg_walkthru1_objtable.png "vsg_walkthru1_objtable")

3. **d3d10 디바이스** 탭에 표시되는 디바이스 상태에 잠재적 문제가 있는지 검사합니다. 해당 기본 형식이 깊이 테스트에 실패했기 때문에 기하 도형이 나타나지 않는 것이므로 깊이 테스트에 영향을 주는 깊이 스텐실과 같은 디바이스 디바이스에 주안점을 둘 수 있습니다. 이 시나리오에서 **깊이 스텐실 설명** ( **출력 병합기 상태**아래에 표시)에는 **깊이 함수** 멤버 `D3D10_COMPARISON_GREATER`에 대한 일반적이지 않은 값이 포함되어 있습니다.

    ![깊이 스텐실 정보를 보여 주는 D3D10 장치 창](media/vsg_walkthru1_devicestate.png "vsg_walkthru1_devicestate")

   렌더링 문제의 원인이 잘못 구성된 깊이 함수라는 사실을 확인한 후에는 이 정보와 코드에 대한 지식을 함께 사용하여 깊이 함수가 잘못 설정된 위치를 찾아 문제를 해결할 수 있습니다. 코드에 친숙하지 않은 경우에는 디버깅 중에 수집한 단서를 사용하여 문제를 검색할 수 있습니다. 예를 들어 이 시나리오에서는 **깊이 스텐실 설명** 을 사용하여 코드에서 "depth" 또는 "GREATER"와 같은 단어를 찾을 수 있습니다. 코드를 수정한 후 다시 빌드하고 앱을 다시 실행하여 렌더링 문제가 해결되었는지 검색합니다.

   ![문제가 수정되기 후의 응용 프로그램](media/vsg_walkthru1_finalview.png "vsg_walkthru1_finalview")