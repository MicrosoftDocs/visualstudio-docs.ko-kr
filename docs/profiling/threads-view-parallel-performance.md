---
title: 동시성 시각화 도우미의 스레드 보기 | Microsoft Docs
description: 스레드 뷰에서 실행 세그먼트 중에 코드를 실행하는 스레드를 식별할 수 있다는 것을 알아봅니다.
ms.date: 11/04/2018
ms.topic: conceptual
f1_keywords:
- vs.performance.view.threadblocking
helpviewer_keywords:
- Concurrency Visualizer, Threads View (Parallel Performance)
ms.assetid: 2e441103-a266-407b-88c3-fb58716257a3
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 619e76b3db67314119782ebc3010465ac7fa622f
ms.sourcegitcommit: 18729d7c99c999865cc2defb17d3d956eb3fe35c
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 01/23/2021
ms.locfileid: "98722726"
---
# <a name="threads-view-in-the-concurrency-visualizer"></a>동시성 시각화 도우미의 스레드 보기

**스레드** 보기는 동시성 시각화 도우미에서 가장 자세하며 다양한 기능을 제공하는 보기입니다. **스레드** 보기에서 실행 세그먼트 중 코드를 실행하는 스레드를 식별하고 동기화, I/O 또는 기타 이유로 인해 스레드가 실행 중인지 또는 차단되는지 분석할 수 있습니다. **스레드** 보기 보고서도 호출 스택 트리 실행 및 스레드 차단 해제를 프로파일링합니다.

스레드가 실행되는 동안 동시성 시각화 도우미는 샘플을 수집합니다. 스레드가 실행을 중지하면 시각화 도우미는 스레드에 대한 모든 운영 체제 컨텍스트 전환 이벤트를 검사합니다. 컨텍스트 전환은 다음과 같은 이유로 발생할 수 있습니다.

- 스레드가 동기화 기본 형식에서 차단되는 경우
- 스레드의 퀀텀이 만료된 경우
- 스레드가 차단 I/O 요청을 하는 경우

동시성 시각화 도우미는 스레드 및 컨텍스트 전환 이벤트를 분류하고 잘 알려진 차단 API에 대한 스레드의 호출 스택을 검사합니다. **스레드** 보기의 왼쪽 아래에 있는 활성 범례에 스레드 범주가 표시됩니다. 대부분의 경우에는 컨텍스트 전환 이벤트에 해당하는 호출 스택을 검사하면 차단 이벤트의 근본 원인을 파악할 수 있습니다.

일치하는 호출 스택이 없는 경우 동시성 시각화 도우미는 [!INCLUDE[TLA#tla_mswin](../code-quality/includes/tlasharptla_mswin_md.md)]에서 제공하는 대기 원인을 사용합니다. 그러나 [!INCLUDE[TLA#tla_mswin](../code-quality/includes/tlasharptla_mswin_md.md)] 범주는 구현 정보를 기반으로 할 수 있으며 사용자의 의도를 반영하지 않을 수도 있습니다. 예를 들어 [!INCLUDE[TLA#tla_mswin](../code-quality/includes/tlasharptla_mswin_md.md)]에서는 기본 슬림 판독기/기록기 잠금에 대한 차단의 대기 원인을 동기화가 아닌 I/O로 보고합니다.

**스레드** 보기에는 스레드 간의 종속성도 표시됩니다. 예를 들어 동기화 개체에서 차단된 스레드를 식별하면 해당 스레드를 차단 해제한 스레드를 찾을 수 있습니다. 차단 해제 스레드가 다른 하나를 차단 해제한 지점에서 호출 스택을 검사할 수 있습니다.

**스레드** 보기를 사용하여 다음을 수행할 수 있습니다.

- 특정 실행 단계 중에 앱의 UI(사용자 인터페이스)가 응답하지 않는 원인을 파악합니다.
- 동기화, I/O, 페이지 폴트 및 기타 이벤트에서 차단에 소요된 시간을 확인합니다.
- 시스템에서 실행되고 있는 다른 프로세스의 간섭 정도를 검색합니다.
- 병렬 실행에 대한 부하 분산 문제를 파악합니다.
- 차선의 확장성 또는 존재하지 않는 확장성에 대한 이유를 찾아봅니다. 예를 들어, 더 많은 논리 코어를 사용 가능할 때 병렬 앱의 성능이 향상되지 않은 이유는 무엇인가요?
- 병렬화에 도움이 되는 앱의 동시성 수준을 이해합니다.
- 작업자 스레드 및 중요한 실행 경로 간의 종속성을 식별합니다.

## <a name="use-threads-view"></a>스레드 보기 사용

동시성 시각화 도우미를 시작하려면 **분석** > **동시성 시각화 도우미** 를 선택한 다음, **새 프로세스 시작** 과 같은 옵션을 선택합니다.

동시성 시각화 도우미는 앱을 시작하고 **컬렉션 중지** 를 선택할 때까지 추적을 수집합니다. 그런 다음, 시각화 도우미는 추적을 분석하고 추적 보고서 페이지에 결과를 표시합니다.

보고서 왼쪽 위에 있는 **스레드** 탭을 선택하여 **스레드** 보기를 엽니다.

![스레드 뷰](../profiling/media/threadsviewnarrowing.png "스레드 뷰")

성능 분석을 시작할 시간 간격 및 스레드를 선택합니다.

## <a name="timeline-analysis"></a>타임라인 분석

**스레드** 보기의 위쪽 부분은 타임라인입니다. 타임라인에는 프로세스의 모든 스레드와 호스트 컴퓨터의 모든 실제 디스크 디바이스의 작업이 표시됩니다. 또한 GPU 작업 및 표식 이벤트도 표시됩니다.

타임라인에서 x축은 시간이고 y축은 여러 채널입니다.

- 시스템의 각 디스크 드라이브에 해당하는 2개 I/O 채널(쓰기용 채널과 읽기용 채널 1개씩)
- 프로세스의 각 스레드에 해당하는 채널
- 추적에 표식 이벤트가 있는 경우 표식 채널. 표식 채널은 처음에는 해당 이벤트를 생성한 스레드 채널 아래에 표시됩니다.
- GPU 채널

초기에는 스레드가 만들어진 순서로 정렬되므로 주 앱 스레드가 맨 먼저 표시됩니다. **실행** 과 같은 다른 기준에 따라 스레드를 선택하려면 **정렬 기준** 드롭다운에서 다른 옵션을 선택합니다.

타임라인 색은 지정된 시간에 스레드 상태를 나타냅니다. 녹색 세그먼트는 실행 중이고, 빨간색 세그먼트는 동기화를 위해 차단되고, 노란색 세그먼트는 선점되며, 자주색 세그먼트는 디바이스 I/O에 사용되었던 스레드를 나타냅니다.

확대하여 자세한 정보를 보거나 축소하여 더 긴 시간 간격의 정보를 볼 수 있습니다. 그래프에서 세그먼트와 점을 선택하여 범주, 시작 시간, 지연 및 호출 스택 상태에 대한 정보를 가져옵니다.

타임라인을 사용하여 병렬 루프 또는 동시 작업과 관련된 스레드 간의 작업 균형을 검사합니다. 한 스레드를 완료하는 데 다른 스레드보다 시간이 오래 걸리면 작업이 불균형하게 분산되었을 수 있습니다. 스레드 간에 작업을 보다 균일하게 분산시키면 프로그램의 성능을 개선할 수 있습니다.

특정 시점에 하나의 스레드만 실행 중이면 앱이 시스템의 동시성을 완전하게 활용하고 있지 않은 것일 수 있습니다. 타임라인 그래프를 사용하여 스레드 간의 종속성과 차단하는 스레드 및 차단되는 스레드 간의 임시 관계를 조사할 수 있습니다. 스레드를 다시 정렬하려면 스레드를 선택한 다음, 도구 모음에서 위쪽 또는 아래쪽 아이콘을 선택합니다.

해당 통계가 관련성이 없고 보고서가 막힐 수 있기 때문에 작업을 수행하지 않거나 완전히 차단된 스레드를 숨길 수 있습니다. 해당 이름을 선택한 다음, **선택한 스레드 숨기기** 또는 도구 모음에서 **선택한 스레드를 제외한 모든 스레드 숨기기** 아이콘을 선택하여 스레드를 숨깁니다. 숨길 스레드를 식별하려면 왼쪽 하단의 **스레드 단위 요약** 링크를 선택합니다. **스레드 단위 요약** 그래프에서 활동이 없는 스레드를 숨길 수 있습니다.

### <a name="thread-execution-details"></a>스레드 실행 정보
실행 세그먼트에 대한 자세한 정보를 가져오려면 타임라인의 녹색 세그먼트에서 한 지점을 선택합니다. 동시성 시각화 도우미는 선택한 지점 위에 검은색 캐럿을 표시하고 아래쪽 창의 **현재** 탭에 해당 호출 스택을 표시합니다. 실행 세그먼트에서 여러 지점을 선택할 수 있습니다.

>[!NOTE]
>세그먼트의 지속 기간이 1밀리초 미만인 경우 동시성 시각화 도우미가 실행 세그먼트에서 선택한 지점을 확인하지 못할 수도 있습니다.

현재 선택한 시간 범위에서 숨겨지지 않은 모든 스레드에 대한 실행 프로필을 가져오려면 왼쪽 하단의 범례에서 **실행** 을 선택합니다.

### <a name="thread-blocking-details"></a>스레드 차단 정보
스레드의 특정 영역에 대한 정보를 가져오려면 타임라인에서 해당 영역을 마우스로 가리키면 도구 설명이 표시됩니다. 도구 설명에는 범주, 시작 시간 및 지연과 같은 정보가 있습니다. 아래쪽 창의 **현재** 탭에 해당 시점의 호출 스택을 표시할 영역을 선택합니다. 이 창에는 범주, 지연, 차단 API(있는 경우), 차단 해제 스레드(있는 경우)도 표시됩니다. 호출 스택을 검사하여 스레드 차단 이벤트의 기본 원인을 확인할 수 있습니다.

실행 경로에는 여러 개의 차단 이벤트가 있을 수 있습니다. 범주를 차단하여 다음을 검토하고 문제 영역을 더 빠르게 찾으려면 왼쪽의 범례에서 차단 범주를 선택합니다.

### <a name="dependencies-between-threads"></a>스레드 간 종속성
동시성 시각화 도우미는 스레드 간 종속성을 표시하므로 차단된 스레드가 수행하려던 작업과 해당 스레드가 작업을 수행할 수 있도록 한 다른 스레드를 확인할 수 있습니다.

다른 스레드를 차단 해제한 스레드를 확인하려면 타임라인에서 차단 세그먼트를 선택합니다. Concurrency 시각화는 차단 해제 스레드를 확인할 수 있으면 차단 해제 스레드와 차단 스레드 뒤에 오는 실행 세그먼트 사이에 선을 그립니다. 아래쪽 창에서 **차단 해제 스택** 탭을 선택하여 관련 호출 스택을 확인합니다.

## <a name="profile-reports"></a>프로필 보고서
타임라인 그래프 아래에는 **프로필 보고서**, **현재** 및 **차단 해제 스택** 보고서 탭을 포함한 창이 있습니다. 타임라인 및 스레드 선택을 변경하면 보고서가 자동으로 업데이트됩니다. 대규모 추적의 경우 업데이트를 계산하는 동안 보고서 창을 일시적으로 사용하지 못할 수도 있습니다.

### <a name="profile-report-tab"></a>프로필 보고서 탭

**프로필 보고서** 에는 두 개의 필터가 있습니다.

- 시간이 거의 소요되지 않은 호출 트리 항목을 필터링하려면 **노이즈 감소율** 필드에 0에서 99% 사이의 필터 값을 입력합니다. 기본값은 2%입니다.
- 코드에 대한 호출 트리만 보려면 **내 코드만** 확인란을 선택합니다. 모든 호출 트리를 보려면 확인란 선택을 취소합니다.

**프로필 보고서** 탭에는 범례의 범주 및 링크에 대한 보고서가 표시됩니다. 보고서를 표시하려면 왼쪽의 항목 중 하나를 선택합니다.

- **Execution** - **실행 보고서** 에는 애플리케이션의 실행에 소요된 시간을 분석한 정보가 표시됩니다.

  실행 시간이 소요된 코드 줄을 찾으려면 호출 트리를 확장하고 호출 트리 항목의 바로 가기 메뉴에서 **소스 보기** 또는 **호출 사이트 보기** 를 선택합니다. **소스 보기** 를 선택하면 실행된 코드 줄을 찾습니다. **호출 사이트 보기** 는 실행된 줄을 호출한 코드 줄을 찾습니다. 호출 사이트 줄이 하나뿐이면 해당 코드가 강조 표시됩니다. 여러 호출 사이트가 있는 경우 대화 상자에서 원하는 호출 사이트를 선택한 다음, **소스로 이동** 을 선택합니다. 이러한 기능은 인스턴스가 가장 많거나, 시간이 가장 길거나, 인스턴스도 가장 많고 시간도 가장 긴 호출 사이트를 찾는 데 매우 유용한 경우가 많습니다. 자세한 내용은 [실행 프로필 보고서](../profiling/execution-profile-report.md)를 참조하세요.

- **Synchronization** - **동기화** 보고서에는 동기화 블록을 처리하는 호출과 각 호출 스택의 총 차단 시간이 표시됩니다. 자세한 내용은 [동기화 시간](../profiling/synchronization-time.md)을 참조하세요.

- **I/O** - **I/O** 보고서에는 I/O 블록을 처리하는 호출과 각 호출 스택의 총 차단 시간이 표시됩니다. 자세한 내용은 [I/O 시간(스레드 보기)](../profiling/i-o-time-threads-view.md)을 참조하세요.

- **Sleep** - **Sleep** 보고서에는 Sleep 블록을 처리하는 호출과 각 호출 스택의 총 차단 시간이 표시됩니다. 자세한 내용은 [절전 모드 시간](../profiling/sleep-time.md)을 참조하세요.

- **Memory Management** - **메모리 관리** 보고서에는 메모리 관리 블록이 발생한 호출 및 각 호출 스택의 총 차단 시간이 표시됩니다. 이 정보를 사용하여 과도한 페이징 또는 가비지 수집 문제가 발생하는 영역을 식별합니다.  자세한 내용은 [메모리 관리 시간](../profiling/memory-management-time.md)을 참조하세요.

- **Preemption** - **선점** 보고서에는 시스템의 프로세스가 현재 프로세스를 선점한 위치와 현재 프로세스의 스레드를 대체하는 개별 스레드가 표시됩니다. 이 정보를 사용하여 가장 많은 선점을 한 프로세스와 스레드를 확인할 수 있습니다. 자세한 내용은 [선점 시간](../profiling/preemption-time.md)을 참조하세요.

- **UI Processing** - **UI 처리** 보고서에는 UI 처리 블록을 처리하는 호출과 각 호출 스택의 총 차단 시간이 표시됩니다. 자세한 내용은 [UI 처리 시간](../profiling/ui-processing-time.md)을 참조하세요.

- **Per Thread Summary** - 현재 선택한 시간 간격에 대한 스레드 상태를 보여주는 그래프를 표시하려면 **스레드 단위 요약** 을 선택합니다. 색으로 구분된 열은 각 스레드가 실행, 차단, I/O 및 기타 상태에서 소비한 총 시간을 표시합니다. 스레드는 아래쪽에 레이블이 지정됩니다. 타임라인 그래프에서 확대/축소 수준을 조정하면 이 그래프는 자동으로 업데이트됩니다.

  특정 확대/축소 수준에서 일부 스레드가 그래프에 표시되지 않을 수 있습니다. 이 경우, 오른쪽에 줄임표 (**...**)가 나타납니다. 확인하려는 스레드가 표시되지 않으면 다른 스레드를 숨길 수 있습니다. 자세한 내용은 [스레드 단위 요약 보고서](../profiling/per-thread-summary-report.md)를 참조하세요.

- **Disk Operations** - **디스크 작업** 을 선택하여 현재 프로세스의 디스크 I/O와 관련된 프로세스 및 스레드, 이러한 스레드와 프로세스가 사용한 파일(예: 로드된 DLL), 읽은 바이트 수 및 기타 정보를 표시합니다. 이 보고서를 사용하여 특히 프로세스가 I/O에 바인딩된 것으로 보이는 경우에 실행 중 파일에 액세스하는 데 걸린 시간을 평가할 수 있습니다. 자세한 내용은 [디스크 작업 보고서](../profiling/disk-operations-report-threads-view.md)를 참조하세요.

### <a name="current-tab"></a>현재 탭
이 탭에는 시간 표시 막대 그래프의 스레드 세그먼트에서 선택한 점에 대한 호출 스택이 표시됩니다. 호출 스택은 앱과 관련된 작업만 표시하도록 잘립니다.

### <a name="unblocking-stack-tab"></a>차단 해제 스택 탭
이 탭에는 선택한 스레드를 차단 해제한 스레드와 차단 해제 호출 스택이 표시됩니다.

## <a name="see-also"></a>추가 정보
- [Concurrency 시각화 도우미](../profiling/concurrency-visualizer.md)
